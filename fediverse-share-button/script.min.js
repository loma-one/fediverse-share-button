(async()=>{const e="false"!==localStorage.getItem("fsb-consent-given"),t=["activitypods","akkoma","anacus","andstatus","anfora","audon","awakari","azorius","bonfire","bookwyrm","bridgy_fed","brighteon_social","brutalinks","buttondown","calckey","castopod","chatter_net","chirp","communecter","diaspora","discourse","dolphin","drupal","emissary","epicyon","f2ap","fedibird","fedify","firefish","flipboard","flockingbird","flohmarkt","forgeflex","forgefriends","forgejo","foundkey","friendica","funkwhale","gancio","gath.io","ghost","gitlab","glitch-soc","gnu_social","goblin","goldfish","gotosocial","greatape","guppe","hollo","hometown","honk","hubzilla","iceshrimp","immers","juick","kazarma","kbin","kepi","ktistec","lemmy","libervia","loforo","loops","mangane","mastodon","mbin","micro.blog","minds","misskey","mistpark","mitra","mobilizon","neodb","nextcloud_social","nodebb","notestock","openengiadina","osada","owncast","peertube","piefed","pinetta","pixelfed","pleroma","plume","podcast_index","postmarks","prismo","quanta","rebased","redaktor","redmatrix","reel2bits","ruffy","seppo","sharky","shuttlecraft","skohub","smithereen","snac","soapbox","socialhome","streams","sublinks","swanye","takahe","takesama","threads","vernissage","viverse","vocata","wafrn","wildebeest","wordpress","write.as","writefreely","wxwclub","xwiki","yeet","zap"],a=["diaspora","firefish","friendica","glitch-soc","hometown","hubzilla","lemmy","mastodon","misskey","pleroma","sharkey","threads"],s={lemmy:'Older lemmy servers <a href="https://github.com/LemmyNet/lemmy-ui/issues/1913" target="_blank">may not work correctly</a>.'},n=(e,t)=>{e.parentElement.parentElement.parentElement.getElementsByClassName("fsb-domain")[0];var a;e.src=`${a=document.getElementsByClassName("fsb-script")[0],src=a.src,src.replace("/script.min.js","")}/icons/${t}.svg`,e.alt=`${t} platform logo`},o=async e=>{if(clearTimeout(d),e.value)d=setTimeout((()=>{r(e)}),c);else{const t=e.parentElement.getElementsByClassName("fsb-icon")[0];n(t,"mastodon")}},r=async e=>{const o=e.parentElement.getElementsByClassName("fsb-button")[0],r=m(e.value),l=await fetch(`https://fediverse-info.stefanbohacek.dev/node-info?domain=${r}&onlysoftware=true`);o.innerHTML=o.innerHTML.replace("Loading","Share");const i=await l.json(),d=i?.software?.name,c=e.parentElement.getElementsByClassName("fsb-icon")[0];e.dataset.software=d,window.fsbGlobalSoftware=d,(e=>{const t=e.parentElement.parentElement.getElementsByClassName("fsb-support-note")[0],n=e.parentElement.parentElement.getElementsByClassName("fsb-domain")[0];t.classList.add("fsb-d-none");let o=e.parentElement.parentElement.getElementsByClassName("fsb-note")[0];o||(o=document.createElement("p"),o.classList.add("fsb-note"),o.classList.add("fsb-d-none"),t.parentNode.insertBefore(o,t.nextSibling));const r=e.parentElement.parentElement.getElementsByClassName("fsb-support-note-link")[0];o&&o.classList.add("fsb-d-none"),a.includes(window.fsbGlobalSoftware)||(r.href=`https://${n.value}`,r.innerHTML=n.value,t.classList.remove("fsb-d-none")),o&&s[window.fsbGlobalSoftware]&&(o.innerHTML=s[window.fsbGlobalSoftware],o.classList.remove("fsb-d-none"))})(o),d&&t.includes(d)?(n(c,d),a.includes(d)&&(o.disabled=!1)):n(c,"question")},l=()=>{let e="";const t=document.querySelector("meta[name='description']")||document.querySelector("meta[property='og:description']")||null;return t&&t.getAttribute&&(e=t.getAttribute("content")),encodeURIComponent(e)},i=()=>encodeURIComponent(window.location.href),m=e=>e.replace(/(^\w+:|^)\/\//,"");let d;const c=1300,f=!!e&&localStorage.getItem("fsb-domain"),p=!!e&&localStorage.getItem("fsb-software");p&&(window.fsbGlobalSoftware=p),[...document.getElementsByClassName("fsb-prompt")].forEach((t=>{const s=t.getElementsByClassName("fsb-domain")[0],r=t.getElementsByClassName("fsb-button")[0];if(f)if(s.value=f,p){s.dataset.software=p,r.disabled=!0;const e=s.parentElement.getElementsByClassName("fsb-icon")[0];n(e,p),a.includes(p)&&(r.disabled=!1)}else o(s);s.addEventListener("input",(()=>{r.disabled=!0;const e=s.parentElement.getElementsByClassName("fsb-icon")[0];(e=>{e.parentElement.parentElement.getElementsByClassName("fsb-support-note")[0].classList.add("fsb-d-none")})(r),n(e,"question"),s.value?r.innerHTML=r.innerHTML.replace("Share","Loading"):(n(e,"question"),r.innerHTML=r.innerHTML.replace("Loading","Share")),o(s)})),s.addEventListener("change",(()=>{})),t.addEventListener("submit",(t=>{t.preventDefault();const a=m(s?.value?.trim());if(a?.length){const t=(()=>{let e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),(t=e).length>5?`${t.substring(0,450)}...`:t;var t})()||(()=>{let e=document.title;try{e=document.querySelector("meta[property='og:title']").getAttribute("content")}catch(e){}return encodeURIComponent(e)})();e&&(localStorage.setItem("fsb-domain",a),window.fsbGlobalSoftware&&localStorage.setItem("fsb-software",window.fsbGlobalSoftware));let n=`https://${a}/share?text=${t+"%0A%0A"+i()}`;s?.dataset?.software&&(["diaspora","friendica"].includes(s.dataset.software)?n=`https://${a}/bookmarklet?url=${i()}&title=${t}&note=${l()}`:"hubzilla"===s.dataset.software?n=`https://${a}/rpost?url=${i()}&body=${t}[br][br]`:"lemmy"===s.dataset.software?n=`https://${a}/create_post?title=${t}&url=${i()}&body=${l()}`:"threads"===s.dataset.software&&(n=`https://${a}/intent/post?text=${t+"%0A%0A"+i()}`)),window.location.assign(n)}}))}))})();//# sourceMappingURL=script.min.js.map
